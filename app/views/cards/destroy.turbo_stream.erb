<%= turbo_stream.remove @card_article_id if @card_article_id %>
<%= turbo_stream.remove @card_container_id if @card_container_id %>

<% if @card_container_id %>
  <%= turbo_stream.append "body" do %>
    <script>
      window.location.href = "<%= board_path(@board) %>";
    </script>
  <% end %>
<% end %>

<% if @source_column %>
  <%= turbo_stream.replace(ActionView::RecordIdentifier.dom_id(@source_column), partial: "boards/show/column", method: :morph, locals: { column: @source_column }) %>
  <%= turbo_stream.append "body" do %>
    <script>
      setTimeout(() => {
        const frame = document.querySelector('#<%= ActionView::RecordIdentifier.dom_id(@source_column, :cards) %>');
        if (frame) frame.reload();
      }, 100);
    </script>
  <% end %>
<% elsif @was_in_stream && @page %>
  <%= turbo_stream.replace("maybe", partial: "boards/show/stream", method: :morph, locals: { board: @board, page: @page }) %>
<% elsif @was_postponed %>
  <%= turbo_stream.replace("not-now", partial: "boards/show/not_now", method: :morph, locals: { board: @board }) %>
  <%= turbo_stream.append "body" do %>
    <script>
      setTimeout(() => {
        const frame = document.querySelector('#not_now_column');
        if (frame) frame.reload();
      }, 100);
    </script>
  <% end %>
<% elsif @was_closed %>
  <%= turbo_stream.replace("closed-cards", partial: "boards/show/closed", method: :morph, locals: { board: @board }) %>
  <%= turbo_stream.append "body" do %>
    <script>
      setTimeout(() => {
        const frame = document.querySelector('#closed_column');
        if (frame) frame.reload();
      }, 100);
    </script>
  <% end %>
<% end %>
